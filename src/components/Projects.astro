---
// Projects Section - Exact Original Design
---

<section class="projects z-[3] min-h-screen relative overflow-hidden pt-24 pb-20 px-5" id="projects" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);">
  <!-- Floating Background -->
  <div class="absolute top-[10%] -right-[10%] w-[500px] h-[500px] rounded-full pointer-events-none animate-float-bg" style="background: radial-gradient(circle, rgba(217, 70, 239, 0.1) 0%, transparent 70%);"></div>

  <!-- Title -->
  <div class="title relative text-center font-bold mb-6">
    <span class="projects-title uppercase" style="background: var(--gradient2); background-size: cover; color: transparent; background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.5)); animation: titleGlow 3s ease-in-out infinite;">My Projects</span>
  </div>

  <!-- Subtitle -->
  <div class="text text-center mb-16">
    <span class="projects-subtitle px-5 py-1.5 inline-block text-center transition-all duration-300" style="color: var(--secondary); background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(59, 130, 246, 0.4); border-radius: 25px; box-shadow: 0 8px 32px rgba(59, 130, 246, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);">A creative project is a moving target. You never end up where you start.</span>
  </div>

    <!-- View Toggle -->
    <div class="view-toggle-container">
        <button class="view-toggle-btn active" data-view="carousel" aria-label="Switch to carousel view">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect>
                <polyline points="17 2 12 7 7 2"></polyline>
            </svg>
            <span>Carousel View</span>
        </button>
        <button class="view-toggle-btn" data-view="grid" aria-label="Switch to grid view">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            <span>Grid View</span>
        </button>
    </div>

    <!-- Project Count -->
    <div class="project-count-container">
        <span id="project-count-text">Showing all projects</span>
    </div>

    <!-- 3D Carousel Container -->
    <div class="carousel-container" id="carousel-container">
        <div class="carousel-wrapper">
            <div class="carousel-track" id="carousel-track">
                <!-- Projects will be loaded here dynamically -->
            </div>
        </div>

        <!-- Carousel Controls -->
        <button class="carousel-btn carousel-prev" id="carousel-prev" aria-label="Previous project">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        </button>
        <button class="carousel-btn carousel-next" id="carousel-next" aria-label="Next project">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        </button>

        <!-- Carousel Indicators -->
        <div class="carousel-indicators" id="carousel-indicators"></div>
    </div>

    <!-- Grid View Container -->
    <div class="max-width grid-container" id="grid-container" style="display: none;">
        <div class="project-content" id="project-content">
            <!-- Projects will be loaded here dynamically -->
        </div>
    </div>
</section>


<style is:global>


@keyframes titleGlow {
    0%, 100% {
        filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.5));
    }
    50% {
        filter: drop-shadow(0 0 30px rgba(240, 147, 251, 0.8));
    }
}

/* Responsive Title and Subtitle */
.projects-title {
    font-size: clamp(2rem, 8vw, 3.5vw);
}

.projects-subtitle {
    font-size: clamp(0.875rem, 3.5vw, 1.3vw);
}

.projects .text {
    font-size: 1.3vw;
    color: var(--secondary);
    text-align: center;
    margin-bottom: 61px;
    word-break: normal;
}

.projects .text span {
    display: inline-block;
    padding: 5px 20px;
    background: rgba(26, 15, 62, 0.4);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(217, 70, 239, 0.3);
    border-radius: 50px;
    box-shadow: 0 5px 20px rgba(217, 70, 239, 0.3);
}

.project-count-container {
    text-align: center;
    margin: 30px auto 40px;
    padding: 0 20px;
}

.project-count-container span {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.8);
    font-weight: 600;
    padding: 10px 25px;
    background: rgba(26, 15, 62, 0.4);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(217, 70, 239, 0.3);
    border-radius: 50px;
    display: inline-block;
    box-shadow: 0 5px 20px rgba(217, 70, 239, 0.3);
}

.projects .box {
    width: 100%;
    max-width: 380px;
    background: rgba(26, 15, 62, 0.3);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    border-radius: 20px;
    margin-bottom: 28px;
    box-shadow: 0 10px 40px rgba(95, 39, 205, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.15);
    transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.projects .box::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: conic-gradient(transparent, transparent, transparent, var(--primary));
    animation: rotateBorder 4s linear infinite;
    opacity: 0;
    transition: opacity 0.4s ease;
}

.projects .box:hover::before {
    opacity: 0.3;
}

.projects .box:hover {
    background: rgba(217, 70, 239, 0.25);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border: 2px solid rgba(217, 70, 239, 0.6);
    transform: translateY(-15px) scale(1.03);
    box-shadow: 0 25px 80px var(--primary), inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.projects .box.hide {
    opacity: 0;
    transform: scale(0.8);
    pointer-events: none;
    position: absolute;
}

.projects .box.show {
    opacity: 1;
    transform: scale(1);
}

.projects .project-image-container {
    position: relative;
    width: 100%;
    height: 230px;
    overflow: hidden;
    border-radius: 18px 18px 0 0;
    background: rgba(0, 0, 0, 0.3);
}

.projects .snapshot {
    width: 100%;
    height: 100%;
    object-fit: cover;
    -webkit-user-drag: none;
    transition: all 0.4s ease;
}

.projects .box:hover .snapshot {
    transform: scale(1.1);
    filter: brightness(1.1);
}

.projects .project-links {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 10px;
    z-index: 10;
}

.projects .project-link-btn {
    width: 40px;
    height: 40px;
    background: rgba(26, 15, 62, 0.8);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    cursor: pointer;
}

.projects .project-link-btn:hover {
    background: rgba(59, 130, 246, 0.8);
    border: 2px solid rgba(59, 130, 246, 0.8);
    transform: scale(1.1) rotate(360deg);
    box-shadow: 0 5px 20px rgba(59, 130, 246, 0.6);
}

.projects .project-link-btn img {
    width: 20px;
    height: 20px;
    filter: invert(1) brightness(2);
    transition: all 0.3s ease;
    opacity: 0.9;
}

.projects .project-link-btn:hover img {
    filter: invert(1) brightness(2) drop-shadow(0 0 8px rgba(255, 255, 255, 1));
    opacity: 1;
}

.projects .project-content-area {
    padding: 20px;
    flex: 1;
    display: flex;
    flex-direction: column;
    text-align: center;
}

.projects .topic {
    font-size: clamp(18px, 1.5vw, 22px);
    font-weight: 900;
    margin: 0 0 15px 0;
    color: var(--secondary);
    transition: all 0.3s ease;
}

.projects .box:hover .topic {
    background: var(--gradient2);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.projects p {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 15px;
    font-size: clamp(13px, 1.1vw, 15px);
    font-weight: 500;
    line-height: 1.6;
    flex: 1;
}

.projects .box:hover p {
    color: var(--secondary);
    font-weight: 600;
}

.projects .tech-stack {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    margin-top: auto;
}

.projects .techs {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: clamp(11px, 0.9vw, 13px);
    font-weight: 600;
    color: var(--secondary);
    background: rgba(59, 130, 246, 0.2);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(59, 130, 246, 0.3);
    transition: all 0.3s ease;
}

.projects .box:hover .techs {
    background: rgba(59, 130, 246, 0.4);
    border: 1px solid rgba(59, 130, 246, 0.6);
    box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
    transform: translateY(-2px);
}

.view-toggle-container {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin: 30px 0 20px;
}

.view-toggle-btn {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 28px;
    background: rgba(26, 15, 62, 0.3);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 2px solid rgba(255, 255, 255, 0.15);
    border-radius: 50px;
    color: var(--secondary);
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    box-shadow: 0 5px 20px rgba(217, 70, 239, 0.2);
}

.view-toggle-btn svg {
    stroke: var(--secondary);
    transition: all 0.3s ease;
}

.view-toggle-btn:hover {
    background: rgba(217, 70, 239, 0.3);
    border: 2px solid rgba(217, 70, 239, 0.6);
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 10px 35px rgba(217, 70, 239, 0.5);
}

.view-toggle-btn.active {
    background: rgba(217, 70, 239, 0.4);
    border: 2px solid rgba(217, 70, 239, 0.7);
    box-shadow: 0 10px 35px rgba(217, 70, 239, 0.6);
}

.view-toggle-btn.active svg {
    stroke: var(--primary);
    filter: drop-shadow(0 0 5px var(--primary));
}

.carousel-container {
    position: relative;
    width: 100%;
    max-width: 1400px;
    margin: 20px auto 40px;
    padding: 20px 20px 80px;
    perspective: 2000px;
}

.carousel-wrapper {
    position: relative;
    width: 100%;
    height: 500px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.carousel-track {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.carousel-item {
    position: absolute;
    width: 380px;
    left: 50%;
    top: 50%;
    transform-style: preserve-3d;
    transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    cursor: pointer;
}

.carousel-item .box {
    width: 100%;
    background: rgba(26, 15, 62, 0.4);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    border-radius: 25px;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(217, 70, 239, 0.4);
    border: 2px solid rgba(255, 255, 255, 0.15);
    transition: all 0.5s ease;
    position: relative;
}

.carousel-item.active .box {
    border: 2px solid rgba(217, 70, 239, 0.8);
    box-shadow: 0 30px 80px rgba(217, 70, 239, 0.7);
    transform: scale(1.05);
}

.carousel-item .project-image-container {
    position: relative;
    width: 100%;
    height: 220px;
    overflow: hidden;
    border-radius: 23px 23px 0 0;
}

.carousel-item .snapshot {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: all 0.5s ease;
}

.carousel-item:hover .snapshot {
    transform: scale(1.1);
    filter: brightness(1.1);
}

.carousel-item .project-content-area {
    padding: 25px;
    text-align: center;
}

.carousel-item .topic {
    font-size: 22px;
    font-weight: 900;
    margin: 0 0 15px 0;
    color: var(--secondary);
    transition: all 0.3s ease;
}

.carousel-item.active .topic {
    background: var(--gradient2);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.carousel-item p {
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 15px;
    font-size: 14px;
    line-height: 1.6;
}

.carousel-item .tech-stack {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    margin-top: 15px;
}

.carousel-item .techs {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    color: var(--secondary);
    background: rgba(59, 130, 246, 0.2);
    border: 1px solid rgba(59, 130, 246, 0.3);
    transition: all 0.3s ease;
}

.carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: rgba(26, 15, 62, 0.8);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    border: 2px solid rgba(217, 70, 239, 0.5);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    box-shadow: 0 10px 40px rgba(217, 70, 239, 0.4);
    z-index: 100;
}

.carousel-btn:hover {
    background: rgba(217, 70, 239, 0.4);
    border: 2px solid rgba(217, 70, 239, 0.8);
    transform: translateY(-50%) scale(1.15);
    box-shadow: 0 15px 50px rgba(217, 70, 239, 0.7);
}

.carousel-btn svg {
    stroke: var(--secondary);
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.carousel-prev {
    left: 20px;
}

.carousel-next {
    right: 20px;
}

.carousel-indicators {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 12px;
    z-index: 100;
}

.carousel-indicator {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    border: 2px solid rgba(255, 255, 255, 0.5);
    cursor: pointer;
    transition: all 0.3s ease;
}

.carousel-indicator:hover {
    background: rgba(217, 70, 239, 0.5);
    border-color: rgba(217, 70, 239, 0.8);
    transform: scale(1.2);
}

.carousel-indicator.active {
    background: var(--gradient2);
    border-color: var(--primary);
    width: 40px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(217, 70, 239, 0.8);
}

.grid-container {
    padding: 0 20px;
}

.project-content {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 30px;
    margin-top: 40px;
}

/* Responsive Styles */
@media (max-width: 420px) {
    .carousel-item {
        width: calc(100% - 10px);
    }
}

/* Mobile Styles (< 640px) */
@media (max-width: 639px) {
    .projects {
        padding: 4rem 1rem 3rem;
    }

    .projects .text {
        margin-bottom: 2rem;
    }

    .projects .text span {
        padding: 8px 15px;
        font-size: 0.875rem;
    }

    .project-count-container {
        margin: 20px auto 30px;
    }

    .project-count-container span {
        font-size: 14px;
        padding: 8px 18px;
    }

    .view-toggle-container {
        gap: 10px;
        margin: 20px 0 15px;
    }

    .view-toggle-btn {
        padding: 10px 16px;
        font-size: 13px;
        gap: 6px;
    }

    .view-toggle-btn span {
        display: none;
    }

    .view-toggle-btn svg {
        width: 18px;
        height: 18px;
    }

    /* Carousel on mobile */
    .carousel-container {
        padding: 15px 10px 60px;
    }

    .carousel-wrapper {
        height: 420px;
    }

    .carousel-item .project-image-container {
        height: 180px;
    }

    .carousel-item .project-content-area {
        padding: 18px;
    }

    .carousel-item .topic {
        font-size: 18px;
        margin-bottom: 12px;
    }

    .carousel-item p {
        font-size: 13px;
        margin-bottom: 12px;
    }

    .carousel-item .tech-stack {
        gap: 6px;
        margin-top: 12px;
    }

    .carousel-item .techs {
        padding: 5px 10px;
        font-size: 11px;
    }

    .carousel-btn {
        width: 45px;
        height: 45px;
    }

    .carousel-btn svg {
        width: 20px;
        height: 20px;
    }

    .carousel-prev {
        left: 5px;
    }

    .carousel-next {
        right: 5px;
    }

    .carousel-indicators {
        bottom: 15px;
        gap: 8px;
    }

    .carousel-indicator {
        width: 10px;
        height: 10px;
    }

    .carousel-indicator.active {
        width: 30px;
    }

    /* Grid view on mobile */
    .grid-container {
        padding: 0 10px;
    }

    .project-content {
        gap: 20px;
        margin-top: 30px;
    }

    .projects .box {
        width: 100%;
        margin-bottom: 20px;
    }

    .projects .project-image-container {
        height: 200px;
    }

    .projects .project-content-area {
        padding: 16px;
    }

    .projects .topic {
        font-size: 18px;
        margin-bottom: 12px;
    }

    .projects p {
        font-size: 13px;
        margin-bottom: 12px;
    }

    .projects .tech-stack {
        gap: 6px;
    }

    .projects .techs {
        padding: 5px 10px;
        font-size: 11px;
    }

    .projects .project-link-btn {
        width: 36px;
        height: 36px;
    }

    .projects .project-link-btn img {
        width: 18px;
        height: 18px;
    }
}

/* Tablet Styles (640px - 1023px) */
@media (min-width: 640px) and (max-width: 1023px) {
    .projects {
        padding: 5rem 1.5rem 4rem;
    }

    .projects .text {
        margin-bottom: 3rem;
    }

    .view-toggle-container {
        margin: 25px 0 18px;
    }

    .view-toggle-btn {
        padding: 11px 22px;
        font-size: 14px;
    }

    /* Carousel on tablet */
    .carousel-wrapper {
        height: 480px;
    }

    .carousel-item {
        width: 340px;
    }

    .carousel-item .project-image-container {
        height: 200px;
    }

    .carousel-item .project-content-area {
        padding: 22px;
    }

    .carousel-item .topic {
        font-size: 20px;
    }

    .carousel-item p {
        font-size: 13.5px;
    }

    .carousel-btn {
        width: 52px;
        height: 52px;
    }

    .carousel-prev {
        left: 12px;
    }

    .carousel-next {
        right: 12px;
    }

    /* Grid view on tablet */
    .project-content {
        gap: 25px;
    }

    .projects .box {
        flex: 1 1 50%;
    }

    .projects .project-image-container {
        height: 210px;
    }
}

/* Medium Laptop Styles (1024px - 1200px) */
@media (min-width: 1024px) and (max-width: 1200px) {
    .carousel-item {
        width: 350px;
    }

    .carousel-item .project-image-container {
        height: 200px;
    }

    .carousel-item .project-content-area {
        padding: 22px;
    }

    .carousel-item .topic {
        font-size: 20px;
    }

    .carousel-item p {
        font-size: 13.5px;
    }

    .carousel-item .techs {
        font-size: 11.5px;
    }

    /* Grid view adjustments */
    .projects .box {
        max-width: 340px;
    }

    .projects .project-image-container {
        height: 210px;
    }

    .projects .project-content-area {
        padding: 18px;
    }

    .projects .topic {
        font-size: 19px;
    }

    .projects p {
        font-size: 13.5px;
    }

    .projects .techs {
        padding: 5px 11px;
        font-size: 11.5px;
    }
}
</style>


<script is:inline>
// Projects functionality - EXACT ORIGINAL
(function() {
    let projectsData = [];
    let currentSlide = 0;
    let totalSlides = 0;
    let currentView = 'carousel';
    let autoplayInterval = null;
    let isAutoplayPaused = false;

    async function loadProjects() {
        try {
            const response = await fetch('/assets/jsons/projects.json');
            projectsData = await response.json();
            totalSlides = projectsData.length;

            initCarouselView();
            initGridView();
            initViewToggle();
            initCarouselControls();

            const countText = document.getElementById('project-count-text');
            if (countText) {
                countText.textContent = 'Showing all ' + projectsData.length + ' projects';
            }
        } catch (error) {
            console.error('Error loading projects:', error);
        }
    }

    function initCarouselView() {
        const carouselTrack = document.getElementById('carousel-track');
        const carouselIndicators = document.getElementById('carousel-indicators');

        if (!carouselTrack) return;

        carouselTrack.innerHTML = '';
        carouselIndicators.innerHTML = '';

        projectsData.forEach(function(project, index) {
            const item = document.createElement('div');
            item.classList.add('carousel-item');
            if (index === 0) item.classList.add('active');

            const liveLink = project.liveProject ?
                '<a href="' + project.liveProject + '" target="_blank" rel="noopener noreferrer" class="project-link-btn" title="Live Demo"><img src="assets/images/projects/link.png" alt="Live"></a>' : '';

            const techsHtml = project.techs.map(function(tech) {
                return '<span class="techs">' + tech + '</span>';
            }).join('');

            item.innerHTML = '<div class="box">' +
                '<div class="project-image-container">' +
                    '<img class="snapshot" src="' + project.image + '" loading="lazy" alt="' + project.title + '">' +
                    '<div class="project-links">' +
                        '<a href="' + project.sourceCode + '" target="_blank" rel="noopener noreferrer" class="project-link-btn" title="Source Code">' +
                            '<img src="assets/images/projects/github.png" alt="GitHub">' +
                        '</a>' +
                        liveLink +
                    '</div>' +
                '</div>' +
                '<div class="project-content-area">' +
                    '<div class="topic">' + project.title + '</div>' +
                    '<p>' + project.description + '</p>' +
                    '<div class="tech-stack">' + techsHtml + '</div>' +
                '</div>' +
            '</div>';

            carouselTrack.appendChild(item);

            const indicator = document.createElement('div');
            indicator.classList.add('carousel-indicator');
            if (index === 0) indicator.classList.add('active');
            indicator.addEventListener('click', function() { goToSlide(index); });
            carouselIndicators.appendChild(indicator);
        });

        positionCarouselItems();
    }

    function initGridView() {
        const projectContent = document.getElementById('project-content');
        if (!projectContent) return;

        projectContent.innerHTML = '';

        projectsData.forEach(function(project) {
            const box = document.createElement('div');
            box.classList.add('box', 'show');

            const liveLink = project.liveProject ?
                '<a href="' + project.liveProject + '" target="_blank" rel="noopener noreferrer" class="project-link-btn" title="Live Demo"><img src="assets/images/projects/link.png" alt="Live"></a>' : '';

            const techsHtml = project.techs.map(function(tech) {
                return '<span class="techs">' + tech + '</span>';
            }).join('');

            box.innerHTML = '<div class="project-image-container">' +
                '<img class="snapshot" src="' + project.image + '" loading="lazy" alt="' + project.title + '">' +
                '<div class="project-links">' +
                    '<a href="' + project.sourceCode + '" target="_blank" rel="noopener noreferrer" class="project-link-btn" title="Source Code">' +
                        '<img src="assets/images/projects/github.png" alt="GitHub">' +
                    '</a>' +
                    liveLink +
                '</div>' +
            '</div>' +
            '<div class="project-content-area">' +
                '<div class="topic">' + project.title + '</div>' +
                '<p>' + project.description + '</p>' +
                '<div class="tech-stack">' + techsHtml + '</div>' +
            '</div>';

            projectContent.appendChild(box);
        });
    }

    function initCarouselControls() {
        const prevBtn = document.getElementById('carousel-prev');
        const nextBtn = document.getElementById('carousel-next');
        const carouselContainer = document.getElementById('carousel-container');

        if (prevBtn) prevBtn.addEventListener('click', function() { changeSlide(-1); });
        if (nextBtn) nextBtn.addEventListener('click', function() { changeSlide(1); });

        document.addEventListener('keydown', function(e) {
            if (currentView !== 'carousel') return;
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
        });

        // Pause autoplay on hover
        if (carouselContainer) {
            carouselContainer.addEventListener('mouseenter', function() {
                isAutoplayPaused = true;
            });

            carouselContainer.addEventListener('mouseleave', function() {
                isAutoplayPaused = false;
            });
        }

        // Start autoplay
        startAutoplay();
    }

    function changeSlide(direction) {
        currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
        updateCarousel();
        resetAutoplay(); // Reset autoplay timer when manually changing slides
    }

    function goToSlide(index) {
        currentSlide = index;
        updateCarousel();
        resetAutoplay(); // Reset autoplay timer when clicking indicator
    }

    // Autoplay functions
    function startAutoplay() {
        if (currentView !== 'carousel') return;
        stopAutoplay(); // Clear any existing interval
        autoplayInterval = setInterval(function() {
            if (!isAutoplayPaused && currentView === 'carousel') {
                changeSlideAuto(1);
            }
        }, 3000); // Change slide every 3 seconds
    }

    function stopAutoplay() {
        if (autoplayInterval) {
            clearInterval(autoplayInterval);
            autoplayInterval = null;
        }
    }

    function resetAutoplay() {
        stopAutoplay();
        startAutoplay();
    }

    function changeSlideAuto(direction) {
        currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
        updateCarousel();
    }

    function updateCarousel() {
        const items = document.querySelectorAll('.carousel-item');
        const indicators = document.querySelectorAll('.carousel-indicator');

        items.forEach(function(item, index) {
            item.classList.remove('active');
            if (index === currentSlide) {
                item.classList.add('active');
            }
        });

        indicators.forEach(function(indicator, index) {
            indicator.classList.remove('active');
            if (index === currentSlide) {
                indicator.classList.add('active');
            }
        });

        positionCarouselItems();
    }

    function positionCarouselItems() {
        const items = document.querySelectorAll('.carousel-item');
        const totalItems = items.length;

        if (totalItems === 0) return;

        const angleStep = 360 / totalItems;
        const radius = 600;

        items.forEach(function(item, index) {
            const angle = ((index - currentSlide) * angleStep) * (Math.PI / 180);
            const x = Math.sin(angle) * radius;
            const z = Math.cos(angle) * radius - radius;
            const scale = 0.6 + (Math.cos(angle) * 0.4);
            const opacity = 0.3 + (Math.cos(angle) * 0.7);

            item.style.transform = 'translateX(calc(-50% + ' + x + 'px)) translateY(-50%) translateZ(' + z + 'px) scale(' + scale + ')';
            item.style.opacity = opacity;
            item.style.zIndex = Math.round(scale * 100);
        });
    }

    function initViewToggle() {
        const toggleBtns = document.querySelectorAll('.view-toggle-btn');
        const carouselContainer = document.getElementById('carousel-container');
        const gridContainer = document.getElementById('grid-container');

        toggleBtns.forEach(function(btn) {
            btn.addEventListener('click', function() {
                const view = btn.dataset.view;

                toggleBtns.forEach(function(b) { b.classList.remove('active'); });
                btn.classList.add('active');

                if (view === 'carousel') {
                    carouselContainer.style.display = 'block';
                    gridContainer.style.display = 'none';
                    currentView = 'carousel';
                    positionCarouselItems();
                    startAutoplay(); // Start autoplay when switching to carousel view
                } else {
                    carouselContainer.style.display = 'none';
                    gridContainer.style.display = 'block';
                    currentView = 'grid';
                    stopAutoplay(); // Stop autoplay when switching to grid view
                }
            });
        });
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadProjects);
    } else {
        loadProjects();
    }
})();
</script>