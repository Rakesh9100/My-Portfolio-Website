---
import { Image } from "astro:assets";

import p1 from '../assets/images/projects/project1.png';
import p2 from '../assets/images/projects/project2.png';
import p3 from '../assets/images/projects/project3.png';
import p4 from '../assets/images/projects/project4.png';
import p5 from '../assets/images/projects/project5.png';
import p6 from '../assets/images/projects/project6.png';
import p7 from '../assets/images/projects/project7.png';
import p8 from '../assets/images/projects/project8.png';

const projectsData = [
    {
        title: "My Portfolio",
        description: "This is my Portfolio website that help others know about me and my works.",
        image: p1,
        techs: ["HTML", "CSS", "JavaScript", "jQuery"],
        sourceCode: "https://github.com/Rakesh9100/My-Portfolio-Website",
        liveProject: "https://rakeshroshan.netlify.app/"
    },
    {
        title: "Beautiify",
        description: "Beautiify comprises a curated selection of beautifully designed components.",
        image: p2,
        techs: ["HTML", "CSS", "JavaScript", "JSON"],
        sourceCode: "https://github.com/Rakesh9100/Beautiify",
        liveProject: "https://beautiify.netlify.app/"
    },
    {
        title: "CalcDiverse",
        description: "CalcDiverse is a customized collection of calculators for various aspects of mathematics.",
        image: p3,
        techs: ["HTML", "CSS", "JavaScript", "JSON"],
        sourceCode: "https://github.com/Rakesh9100/CalcDiverse",
        liveProject: "https://calcdiverse.netlify.app/"
    },
    {
        title: "Eventica",
        description: "Eventica is an ultimate guide to the dynamic and diverse events in Bangalore.",
        image: p4,
        techs: ["HTML", "CSS", "JavaScript", "JSON"],
        sourceCode: "https://github.com/Rakesh9100/Eventica",
        liveProject: "https://eventica.netlify.app/"
    },
    {
        title: "ML Project Drug Review Dataset",
        description: "This is an innovative machine learning project that utilizes patient reviews to analyze the drugs effectiveness.",
        image: p5,
        techs: ["Python", "Machine Learning", "Deep Learning"],
        sourceCode: "https://github.com/Rakesh9100/ML-Project-Drug-Review-Dataset",
        liveProject: "https://ml-project-drug-review-dataset-main.streamlit.app/"
    },
    {
        title: "Click The Edible Game",
        description: "A well-designed interesting game where you can play with your favourite edible and click it to get the most scores.",
        image: p6,
        techs: ["HTML", "CSS", "JavaScript"],
        sourceCode: "https://github.com/Rakesh9100/Click-The-Edible-Game",
        liveProject: "https://click-the-edible-game.netlify.app/"
    },
    {
        title: "Greeting Time",
        description: "This is a project which fetch the time from the system and greet the user according to the time fetched.",
        image: p7,
        techs: ["C++"],
        sourceCode: "https://github.com/Rakesh9100/Greeting-Time",
        liveProject: ""
    },
    {
        title: "InstaStore",
        description: "InstaStore is a python coded script to download Photos & Videos from Instagram without any API access.",
        image: p8,
        techs: ["Python", "GUI"],
        sourceCode: "https://github.com/Rakesh9100/InstaStore",
        liveProject: ""
    }
];
---

<section class="projects z-[3] min-h-screen relative overflow-hidden pt-24 pb-20 px-5" id="projects" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);">
    <!-- Floating Background -->
    <div class="absolute top-[10%] -right-[10%] w-[500px] h-[500px] rounded-full pointer-events-none animate-float-bg" style="background: radial-gradient(circle, rgba(217, 70, 239, 0.1) 0%, transparent 70%);"></div>
    <!-- Title -->
    <div class="title relative text-center font-bold mb-6">
        <span class="projects-title uppercase" style="background: var(--gradient2); background-size: cover; color: transparent; background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.5)); animation: titleGlow 3s ease-in-out infinite;">My Projects</span>
    </div>
    <!-- Subtitle -->
    <div class="text text-center mb-16">
        <span class="quote-text">A creative project is a moving target. You never end up where you start.</span>
    </div>
    <!-- View Toggle -->
    <div class="view-toggle-container">
        <button class="view-toggle-btn active" data-view="carousel" aria-label="Switch to carousel view">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect>
                <polyline points="17 2 12 7 7 2"></polyline>
            </svg>
            <span>Carousel View</span>
        </button>
        <button class="view-toggle-btn" data-view="grid" aria-label="Switch to grid view">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            <span>Grid View</span>
        </button>
    </div>
    <!-- Project Count -->
    <div class="project-count-container">
        <span id="project-count-text">Showing project 1 of {projectsData.length}</span>
    </div>
    <!-- 3D Carousel Container -->
    <div class="carousel-container" id="carousel-container">
        <div class="carousel-wrapper">
            <div class="carousel-track" id="carousel-track">
                {projectsData.map((project, index) => (
                <div class="carousel-item {index === 0 ? 'active' : ''}">
                    <div class="box">
                        <div class="project-image-container">
                            <Image src={project.image} alt={project.title} class="snapshot" format="webp" loading="lazy" />
                            <div class="project-links">
                                <!-- GitHub -->
                                <a href={project.sourceCode} target="_blank" rel="noopener noreferrer" class="project-link-btn">
                                <img src="/assets/images/projects/github.png" alt="GitHub" />
                                </a>
                                <!-- Live link -->
                                {project.liveProject && (
                                <a href={project.liveProject} target="_blank" rel="noopener noreferrer" class="project-link-btn">
                                <img src="/assets/images/projects/link.png" alt="Live" />
                                </a>
                                )}
                            </div>
                        </div>
                        <div class="project-content-area">
                            <div class="topic">{project.title}</div>
                            <p>{project.description}</p>
                            <div class="tech-stack">
                                {project.techs.map(tech => (
                                <span class="techs">{tech}</span>
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
                ))}
            </div>
        </div>
        <!-- Carousel Controls -->
        <button class="carousel-btn carousel-prev" id="carousel-prev" aria-label="Previous project">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        </button>
        <button class="carousel-btn carousel-next" id="carousel-next" aria-label="Next project">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        </button>
        <!-- Carousel Indicators -->
        <div class="carousel-indicators" id="carousel-indicators">
            {projectsData.map((_, index) => (
            <div class={`carousel-indicator ${index === 0 ? 'active' : ''}`}>
        </div>
        ))}
    </div>
    </div>
    <!-- Grid View Container -->
    <div class="max-width grid-container" id="grid-container" style="display: none;">
        <div class="project-content" id="project-content">
            {projectsData.map(project => (
            <div class="box show">
                <div class="project-image-container">
                    <Image src={project.image} alt={project.title} class="snapshot" format="webp" loading="lazy" />
                    <div class="project-links">
                        <a href={project.sourceCode} target="_blank" rel="noopener noreferrer" class="project-link-btn">
                        <img src="/assets/images/projects/github.png" alt="GitHub" />
                        </a>
                        {project.liveProject && (
                        <a href={project.liveProject} target="_blank" rel="noopener noreferrer" class="project-link-btn">
                        <img src="/assets/images/projects/link.png" alt="Live" />
                        </a>
                        )}
                    </div>
                </div>
                <div class="project-content-area">
                    <div class="topic">{project.title}</div>
                    <p>{project.description}</p>
                    <div class="tech-stack">
                        {project.techs.map(tech => (
                        <span class="techs">{tech}</span>
                        ))}
                    </div>
                </div>
            </div>
            ))}
        </div>
    </div>
</section>

<style is:global>
    .quote-text {
        font-size: clamp(0.875rem, 3.5vw, 1.3vw);
        padding: 0.375rem 1.25rem;
        display: inline-block;
        text-align: center;
        transition: all 0.3s ease;
        color: var(--secondary);
        background: rgba(26, 15, 62, 0.3);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(59, 130, 246, 0.4);
        border-radius: 25px;
        box-shadow: 0 8px 32px rgba(59, 130, 246, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    @keyframes titleGlow {
        0%,
        100% {
            filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.5));
        }

        50% {
            filter: drop-shadow(0 0 30px rgba(240, 147, 251, 0.8));
        }
    }

    @keyframes rotateBorder {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .projects-title {
        font-size: clamp(2rem, 8vw, 3.5vw);
    }

    .project-count-container {
        text-align: center;
        margin: 30px auto 40px;
        padding: 0 20px;
    }

    .project-count-container span {
        font-size: 16px;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 600;
        padding: 10px 25px;
        background: rgba(26, 15, 62, 0.4);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(217, 70, 239, 0.3);
        border-radius: 50px;
        display: inline-block;
        box-shadow: 0 5px 20px rgba(217, 70, 239, 0.3);
    }

    .projects .box {
        width: 100%;
        max-width: 380px;
        background: rgba(26, 15, 62, 0.3);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border-radius: 20px;
        margin-bottom: 28px;
        box-shadow: 0 10px 40px rgba(95, 39, 205, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.1);
        border: 2px solid rgba(255, 255, 255, 0.15);
        transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    .projects .box::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: conic-gradient(transparent, transparent, transparent, var(--primary));
        animation: rotateBorder 4s linear infinite;
        opacity: 0;
        transition: opacity 0.4s ease;
    }

    .projects .box:hover::before {
        opacity: 0.3;
    }

    .projects .box:hover {
        background: rgba(217, 70, 239, 0.25);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border: 2px solid rgba(217, 70, 239, 0.6);
        transform: translateY(-15px) scale(1.03);
        box-shadow: 0 25px 80px var(--primary), inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    .projects .box.hide {
        opacity: 0;
        transform: scale(0.8);
        pointer-events: none;
        position: absolute;
    }

    .projects .box.show {
        opacity: 1;
        transform: scale(1);
    }

    .projects .project-image-container {
        position: relative;
        width: 100%;
        height: 230px;
        overflow: hidden;
        border-radius: 18px 18px 0 0;
        background: rgba(0, 0, 0, 0.3);
    }

    .projects .snapshot {
        width: 100%;
        height: 100%;
        object-fit: cover;
        -webkit-user-drag: none;
        transition: all 0.4s ease;
    }

    .projects .box:hover .snapshot {
        transform: scale(1.1);
        filter: brightness(1.1);
    }

    .projects .project-links {
        position: absolute;
        top: 10px;
        right: 10px;
        display: flex;
        gap: 10px;
        z-index: 10;
    }

    .projects .project-link-btn {
        width: 40px;
        height: 40px;
        background: rgba(26, 15, 62, 0.8);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        cursor: pointer;
    }

    .projects .project-link-btn:hover {
        background: rgba(59, 130, 246, 0.8);
        border: 2px solid rgba(59, 130, 246, 0.8);
        transform: scale(1.1) rotate(360deg);
        box-shadow: 0 5px 20px rgba(59, 130, 246, 0.6);
    }

    .projects .project-link-btn img {
        width: 20px;
        height: 20px;
        filter: invert(1) brightness(2);
        transition: all 0.3s ease;
        opacity: 0.9;
    }

    .projects .project-link-btn:hover img {
        filter: invert(1) brightness(2) drop-shadow(0 0 8px rgba(255, 255, 255, 1));
        opacity: 1;
    }

    .projects .project-content-area {
        padding: 20px;
        flex: 1;
        display: flex;
        flex-direction: column;
        text-align: center;
    }

    .projects .topic {
        font-size: clamp(18px, 1.5vw, 22px);
        font-weight: 900;
        margin: 0 0 15px 0;
        color: var(--secondary);
        transition: all 0.3s ease;
    }

    .projects .box:hover .topic {
        background: var(--gradient2);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .projects p {
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 15px;
        font-size: clamp(13px, 1.1vw, 15px);
        font-weight: 500;
        line-height: 1.6;
        flex: 1;
    }

    .projects .box:hover p {
        color: var(--secondary);
        font-weight: 600;
    }

    .projects .tech-stack {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
        margin-top: auto;
    }

    .projects .techs {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: clamp(11px, 0.9vw, 13px);
        font-weight: 600;
        color: var(--secondary);
        background: rgba(59, 130, 246, 0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(59, 130, 246, 0.3);
        transition: all 0.3s ease;
    }

    .projects .box:hover .techs {
        background: rgba(59, 130, 246, 0.4);
        border: 1px solid rgba(59, 130, 246, 0.6);
        box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        transform: translateY(-2px);
    }

    .view-toggle-container {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 30px 0 20px;
    }

    .view-toggle-btn {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 28px;
        background: rgba(26, 15, 62, 0.3);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 2px solid rgba(255, 255, 255, 0.15);
        border-radius: 50px;
        color: var(--secondary);
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        box-shadow: 0 5px 20px rgba(217, 70, 239, 0.2);
    }

    .view-toggle-btn svg {
        stroke: var(--secondary);
        transition: all 0.3s ease;
    }

    .view-toggle-btn:hover {
        background: rgba(217, 70, 239, 0.3);
        border: 2px solid rgba(217, 70, 239, 0.6);
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 10px 35px rgba(217, 70, 239, 0.5);
    }

    .view-toggle-btn.active {
        background: rgba(217, 70, 239, 0.4);
        border: 2px solid rgba(217, 70, 239, 0.7);
        box-shadow: 0 10px 35px rgba(217, 70, 239, 0.6);
    }

    .view-toggle-btn.active svg {
        stroke: var(--primary);
        filter: drop-shadow(0 0 5px var(--primary));
    }

    .carousel-container {
        position: relative;
        width: 100%;
        max-width: 1400px;
        margin: 20px auto 40px;
        padding: 20px 20px 80px;
        perspective: 2000px;
    }

    .carousel-wrapper {
        position: relative;
        width: 100%;
        height: 500px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .carousel-track {
        position: relative;
        width: 100%;
        height: 100%;
        transform-style: preserve-3d;
        transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .carousel-item {
        position: absolute;
        width: 380px;
        left: 50%;
        top: 50%;
        transform-style: preserve-3d;
        transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        cursor: pointer;
    }

    .carousel-item .box {
        width: 100%;
        background: rgba(26, 15, 62, 0.4);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        border-radius: 25px;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(217, 70, 239, 0.4);
        border: 2px solid rgba(255, 255, 255, 0.15);
        transition: all 0.5s ease;
        position: relative;
    }

    .carousel-item.active .box {
        border: 2px solid rgba(217, 70, 239, 0.8);
        box-shadow: 0 30px 80px rgba(217, 70, 239, 0.7);
        transform: scale(1.05);
    }

    .carousel-item .project-image-container {
        position: relative;
        width: 100%;
        height: 220px;
        overflow: hidden;
        border-radius: 23px 23px 0 0;
    }

    .carousel-item .snapshot {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: all 0.5s ease;
    }

    .carousel-item:hover .snapshot {
        transform: scale(1.1);
        filter: brightness(1.1);
    }

    .carousel-item .project-content-area {
        padding: 25px;
        text-align: center;
    }

    .carousel-item .topic {
        font-size: 22px;
        font-weight: 900;
        margin: 0 0 15px 0;
        color: var(--secondary);
        transition: all 0.3s ease;
    }

    .carousel-item.active .topic {
        background: var(--gradient2);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .carousel-item p {
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 15px;
        font-size: 14px;
        line-height: 1.6;
    }

    .carousel-item .tech-stack {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
        margin-top: 15px;
    }

    .carousel-item .techs {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        color: var(--secondary);
        background: rgba(59, 130, 246, 0.2);
        border: 1px solid rgba(59, 130, 246, 0.3);
        transition: all 0.3s ease;
    }

    .carousel-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: rgba(26, 15, 62, 0.8);
        backdrop-filter: blur(25px);
        -webkit-backdrop-filter: blur(25px);
        border: 2px solid rgba(217, 70, 239, 0.5);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        box-shadow: 0 10px 40px rgba(217, 70, 239, 0.4);
        z-index: 100;
    }

    .carousel-btn:hover {
        background: rgba(217, 70, 239, 0.4);
        border: 2px solid rgba(217, 70, 239, 0.8);
        transform: translateY(-50%) scale(1.15);
        box-shadow: 0 15px 50px rgba(217, 70, 239, 0.7);
    }

    .carousel-btn svg {
        stroke: var(--secondary);
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    .carousel-prev {
        left: 20px;
    }

    .carousel-next {
        right: 20px;
    }

    .carousel-indicators {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 12px;
        z-index: 100;
    }

    .carousel-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .carousel-indicator:hover {
        background: rgba(217, 70, 239, 0.5);
        border-color: rgba(217, 70, 239, 0.8);
        transform: scale(1.2);
    }

    .carousel-indicator.active {
        background: var(--gradient2);
        border-color: var(--primary);
        width: 40px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(217, 70, 239, 0.8);
    }

    .grid-container {
        padding: 0 20px;
    }

    .project-content {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 30px;
        margin-top: 40px;
    }

    /* Medium Desktop (1024px - 1200px) */
    @media (min-width: 1024px) and (max-width: 1200px) {
        .carousel-item {
            width: 350px;
        }

        .carousel-item .project-image-container {
            height: 200px;
        }

        .carousel-item .project-content-area {
            padding: 22px;
        }

        .carousel-item .topic {
            font-size: 20px;
        }

        .carousel-item p {
            font-size: 13.5px;
        }

        .carousel-item .techs {
            font-size: 11.5px;
        }

        .projects .box {
            max-width: 340px;
        }

        .projects .project-image-container {
            height: 210px;
        }

        .projects .project-content-area {
            padding: 18px;
        }

        .projects .topic {
            font-size: 19px;
        }

        .projects p {
            font-size: 13.5px;
        }

        .projects .techs {
            padding: 5px 11px;
            font-size: 11.5px;
        }
    }

    /* Tablet (640px - 1023px) */
    @media (min-width: 640px) and (max-width: 1023px) {
        .projects {
            padding: 5rem 1.5rem 4rem;
        }

        .text {
            margin-bottom: 3rem;
        }

        .view-toggle-container {
            margin: 25px 0 18px;
        }

        .view-toggle-btn {
            padding: 11px 22px;
            font-size: 14px;
        }

        .carousel-wrapper {
            height: 480px;
        }

        .carousel-item {
            width: 340px;
        }

        .carousel-item .project-image-container {
            height: 200px;
        }

        .carousel-item .project-content-area {
            padding: 22px;
        }

        .carousel-item .topic {
            font-size: 20px;
        }

        .carousel-item p {
            font-size: 13.5px;
        }

        .carousel-btn {
            width: 52px;
            height: 52px;
        }

        .carousel-prev {
            left: 12px;
        }

        .carousel-next {
            right: 12px;
        }

        .project-content {
            gap: 25px;
        }

        .projects .box {
            flex: 1 1 50%;
        }

        .projects .project-image-container {
            height: 210px;
        }
    }

    /* Mobile and small tablet (max-width: 768px) */
    @media (max-width: 768px) {
        .animate-float-bg {
            animation: none !important;
            opacity: 0.15 !important;
            width: 220px !important;
            height: 220px !important;
            transform: none !important;
        }

        .projects-title {
            animation: none !important;
            filter: none !important;
        }

        .quote-text {
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            box-shadow: none !important;
            background: rgba(26, 15, 62, 0.5) !important;
        }

        .view-toggle-container {
            display: none !important;
        }

        .projects .box,
        .carousel-item .box {
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            background: rgba(26, 15, 62, 0.5) !important;
            box-shadow: none !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            transform: none !important;
        }

        .projects .box:hover,
        .carousel-item:hover .snapshot,
        .projects .box:hover .snapshot {
            transform: none !important;
            box-shadow: none !important;
            filter: none !important;
            background: rgba(26, 15, 62, 0.5) !important;
        }

        .projects .box::before {
            display: none !important;
        }

        .projects .techs,
        .carousel-item .techs {
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            box-shadow: none !important;
            transform: none !important;
        }

        .projects .project-link-btn {
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
            transform: none !important;
            box-shadow: none !important;
        }

        .projects .project-link-btn:hover {
            transform: none !important;
            box-shadow: none !important;
            background: rgba(26, 15, 62, 0.7) !important;
        }

        .carousel-container {
            display: none !important;
        }

        #grid-container {
            display: block !important;
        }

        #carousel-prev,
        #carousel-next,
        #carousel-indicators {
            display: none !important;
        }

        .carousel-item {
            transform: none !important;
            opacity: 1 !important;
        }

        .projects .box {
            border-radius: 16px !important;
        }

        .carousel-track,
        .carousel-wrapper {
            transform: none !important;
            perspective: none !important;
        }
    }

    /* Small mobile (max-width: 639px) */
    @media (max-width: 639px) {
        .projects {
            padding: 4rem 1rem 3rem;
        }

        .text {
            margin-bottom: 2rem;
        }

        .quote-text {
            padding: 0.5rem 0.9375rem;
            font-size: 0.875rem;
        }

        .project-count-container {
            margin: 20px auto 30px;
        }

        .project-count-container span {
            font-size: 14px;
            padding: 8px 18px;
        }

        .view-toggle-container {
            gap: 10px;
            margin: 20px 0 15px;
        }

        .view-toggle-btn {
            padding: 10px 16px;
            font-size: 13px;
            gap: 6px;
        }

        .view-toggle-btn span {
            display: none;
        }

        .view-toggle-btn svg {
            width: 18px;
            height: 18px;
        }

        .carousel-container {
            padding: 15px 10px 60px;
        }

        .carousel-wrapper {
            height: 420px;
        }

        .carousel-item .project-image-container {
            height: 180px;
        }

        .carousel-item .project-content-area {
            padding: 18px;
        }

        .carousel-item .topic {
            font-size: 18px;
            margin-bottom: 12px;
        }

        .carousel-item p {
            font-size: 13px;
            margin-bottom: 12px;
        }

        .carousel-item .tech-stack {
            gap: 6px;
            margin-top: 12px;
        }

        .carousel-item .techs {
            padding: 5px 10px;
            font-size: 11px;
        }

        .carousel-btn {
            width: 45px;
            height: 45px;
        }

        .carousel-btn svg {
            width: 20px;
            height: 20px;
        }

        .carousel-prev {
            left: 5px;
        }

        .carousel-next {
            right: 5px;
        }

        .carousel-indicators {
            bottom: 15px;
            gap: 8px;
        }

        .carousel-indicator {
            width: 10px;
            height: 10px;
        }

        .carousel-indicator.active {
            width: 30px;
        }

        .grid-container {
            padding: 0 10px;
        }

        .project-content {
            gap: 20px;
            margin-top: 30px;
        }

        .projects .box {
            width: 100%;
            margin-bottom: 20px;
        }

        .projects .project-image-container {
            height: 200px;
        }

        .projects .project-content-area {
            padding: 16px;
        }

        .projects .topic {
            font-size: 18px;
            margin-bottom: 12px;
        }

        .projects p {
            font-size: 13px;
            margin-bottom: 12px;
        }

        .projects .tech-stack {
            gap: 6px;
        }

        .projects .techs {
            padding: 5px 10px;
            font-size: 11px;
        }

        .projects .project-link-btn {
            width: 36px;
            height: 36px;
        }

        .projects .project-link-btn img {
            width: 18px;
            height: 18px;
        }
    }

    /* Extra small mobile (max-width: 420px) */
    @media (max-width: 420px) {
        .carousel-item {
            width: calc(100% - 10px);
        }
    }
</style>

<script is:inline define:vars={{ projectsData }}>
(function () {
    // State management
    const state = {
        currentSlide: 0,
        autoplayInterval: null,
        isAutoplayPaused: false,
        currentView: "carousel",
        totalProjects: projectsData.length,
        isInitialized: false
    };

    // Configuration
    const config = {
        autoplayDelay: 3000,
        carouselRadius: 600,
        angleStep: 360 / state.totalProjects,
        scaleRange: { min: 0.6, max: 1.0 },
        opacityRange: { min: 0.3, max: 1.0 }
    };

    // Cache DOM elements
    const elements = {
        items: () => document.querySelectorAll('.carousel-item'),
        indicators: () => document.querySelectorAll('.carousel-indicator'),
        prevBtn: document.getElementById('carousel-prev'),
        nextBtn: document.getElementById('carousel-next'),
        carouselContainer: document.getElementById('carousel-container'),
        gridContainer: document.getElementById('grid-container'),
        toggleBtns: () => document.querySelectorAll('.view-toggle-btn'),
        projectCount: document.getElementById('project-count-text')
    };

    // Optimized carousel positioning with requestAnimationFrame
    function positionCarouselItems() {
        const items = elements.items();
        if (items.length === 0) return;

        requestAnimationFrame(() => {
            items.forEach((item, index) => {
                const angle = ((index - state.currentSlide) * config.angleStep) * (Math.PI / 180);
                const cosAngle = Math.cos(angle);
                
                const x = Math.sin(angle) * config.carouselRadius;
                const z = cosAngle * config.carouselRadius - config.carouselRadius;
                const scale = config.scaleRange.min + (cosAngle * (config.scaleRange.max - config.scaleRange.min));
                const opacity = config.opacityRange.min + (cosAngle * (config.opacityRange.max - config.opacityRange.min));

                // Batch DOM updates
                const transform = `translateX(calc(-50% + ${x}px)) translateY(-50%) translateZ(${z}px) scale(${scale})`;
                item.style.cssText = `
                    transform: ${transform};
                    opacity: ${opacity};
                    z-index: ${Math.round(scale * 100)};
                `;
            });
        });
    }

    // Optimized carousel update
    function updateCarousel() {
        if (!state.isInitialized) return;

        const items = elements.items();
        const indicators = elements.indicators();

        // Batch class updates
        items.forEach((item, index) => {
            item.classList.toggle('active', index === state.currentSlide);
        });

        indicators.forEach((indicator, index) => {
            indicator.classList.toggle('active', index === state.currentSlide);
        });

        positionCarouselItems();
        updateProjectCount();
    }

    // Slide navigation with bounds checking
    function changeSlide(direction) {
        state.currentSlide = (state.currentSlide + direction + state.totalProjects) % state.totalProjects;
        updateCarousel();
        resetAutoplay();
    }

    function goToSlide(index) {
        if (index >= 0 && index < state.totalProjects) {
            state.currentSlide = index;
            updateCarousel();
            resetAutoplay();
        }
    }

    // Autoplay management
    function startAutoplay() {
        if (state.currentView !== "carousel") return;
        
        stopAutoplay();
        state.autoplayInterval = setInterval(() => {
            if (!state.isAutoplayPaused) {
                changeSlide(1);
            }
        }, config.autoplayDelay);
    }

    function stopAutoplay() {
        if (state.autoplayInterval) {
            clearInterval(state.autoplayInterval);
            state.autoplayInterval = null;
        }
    }

    function resetAutoplay() {
        if (state.currentView === "carousel") {
            stopAutoplay();
            startAutoplay();
        }
    }

    // View switching with proper cleanup
    function switchView(view) {
        if (view === state.currentView) return;

        state.currentView = view;
        
        if (view === "carousel") {
            elements.carouselContainer.style.display = "block";
            elements.gridContainer.style.display = "none";
            startAutoplay();
            updateCarousel();
        } else {
            elements.carouselContainer.style.display = "none";
            elements.gridContainer.style.display = "block";
            stopAutoplay();
        }

        // Update project count text
        updateProjectCount();
    }

    // Event handlers with proper delegation
    function handleKeydown(e) {
        if (state.currentView !== 'carousel') return;
        
        switch(e.key) {
            case "ArrowLeft":
                e.preventDefault();
                changeSlide(-1);
                break;
            case "ArrowRight":
                e.preventDefault();
                changeSlide(1);
                break;
        }
    }

    function handleMouseEnter() {
        state.isAutoplayPaused = true;
    }

    function handleMouseLeave() {
        state.isAutoplayPaused = false;
    }

    // Initialize carousel controls
    function initCarouselControls() {
        // Navigation buttons
        elements.prevBtn?.addEventListener('click', () => changeSlide(-1));
        elements.nextBtn?.addEventListener('click', () => changeSlide(1));

        // Indicators with event delegation
        const indicatorsContainer = elements.indicators()[0]?.parentElement;
        if (indicatorsContainer) {
            indicatorsContainer.addEventListener('click', (e) => {
                const indicator = e.target.closest('.carousel-indicator');
                if (indicator) {
                    const index = Array.from(elements.indicators()).indexOf(indicator);
                    goToSlide(index);
                }
            });
        }

        // Keyboard navigation
        document.addEventListener('keydown', handleKeydown);

        // Mouse hover controls
        if (elements.carouselContainer) {
            elements.carouselContainer.addEventListener('mouseenter', handleMouseEnter);
            elements.carouselContainer.addEventListener('mouseleave', handleMouseLeave);
        }
    }

    // Initialize view toggle
    function initViewToggle() {
        const toggleBtns = elements.toggleBtns();
        
        toggleBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // Update active state
                toggleBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // Switch view
                switchView(btn.dataset.view);
            });
        });
    }

    // Update project count based on current view and device
    function updateProjectCount() {
        if (!elements.projectCount) return;

        // Check if we're in mobile view (carousel is hidden)
        const isMobileView = window.innerWidth <= 768 || 
                           (elements.carouselContainer && 
                            window.getComputedStyle(elements.carouselContainer).display === 'none');

        if (isMobileView || state.currentView === "grid") {
            elements.projectCount.textContent = `Showing all ${state.totalProjects} projects`;
        } else {
            elements.projectCount.textContent = `Showing project ${state.currentSlide + 1} of ${state.totalProjects}`;
        }
    }

    // Initialize project count
    function initProjectCount() {
        updateProjectCount();
        
        // Update count on window resize
        window.addEventListener('resize', updateProjectCount);
    }

    // Cleanup function for page unload
    function cleanup() {
        stopAutoplay();
        document.removeEventListener('keydown', handleKeydown);
        window.removeEventListener('resize', updateProjectCount);
        if (elements.carouselContainer) {
            elements.carouselContainer.removeEventListener('mouseenter', handleMouseEnter);
            elements.carouselContainer.removeEventListener('mouseleave', handleMouseLeave);
        }
    }

    // Main initialization
    function init() {
        if (state.isInitialized) return;
        
        try {
            initCarouselControls();
            initViewToggle();
            initProjectCount();
            
            // Set initial state
            state.isInitialized = true;
            
            // Initial update for mobile detection
            updateProjectCount();
            
            startAutoplay();
            updateCarousel();
            
            // Cleanup on page unload
            window.addEventListener('beforeunload', cleanup);
            
        } catch (error) {
            console.error('Projects carousel initialization failed:', error);
        }
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})(); 
</script>