---
import experiencesData from '../../public/assets/jsons/experiences.json';
const experiences = experiencesData;
---

<section class="experience z-[3] h-full min-h-screen relative overflow-hidden py-24 px-5 pb-20" id="experience" style="background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);">
  <!-- Floating Background -->
  <div class="absolute top-[10%] -left-[15%] w-[500px] h-[500px] rounded-full animate-float-bg" style="background: radial-gradient(circle, rgba(59, 130, 246, 0.12) 0%, transparent 70%);"></div>
  <div class="absolute bottom-[20%] -right-[10%] w-[600px] h-[600px] rounded-full animate-float-bg-reverse" style="background: radial-gradient(circle, rgba(217, 70, 239, 0.12) 0%, transparent 70%);"></div>

  <div class="title relative text-center font-bold mb-6">
    <span class="experience-title uppercase" style="background: var(--gradient2); background-size: cover; color: transparent; background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.5)); animation: titleGlow 3s ease-in-out infinite;">My Experience</span>
  </div>

  <div class="text text-center mb-16">
    <span class="experience-subtitle px-4 py-1 inline-block text-center" style="color: var(--secondary); background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(59, 130, 246, 0.4); border-radius: 25px; box-shadow: 0 8px 32px rgba(59, 130, 246, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);">Experience is the teacher of all things.</span>
  </div>

  <!-- Experience Filter -->
  <div class="experience-filter flex justify-center gap-4 flex-wrap my-10 mx-auto px-5 relative z-10">
    <button class="exp-filter-btn active flex items-center gap-2 px-6 py-3 rounded-full text-white text-[15px] font-semibold cursor-pointer relative overflow-hidden transition-all duration-400" data-filter="all" style="background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 2px solid rgba(255, 255, 255, 0.15); box-shadow: 0 5px 20px rgba(59, 130, 246, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);">
      <span class="filter-icon text-xl">ðŸŒŸ</span>
      <span class="filter-text-full">All</span>
      <span class="filter-text-short hidden">All</span>
    </button>
    <button class="exp-filter-btn flex items-center gap-2 px-6 py-3 rounded-full text-white text-[15px] font-semibold cursor-pointer relative overflow-hidden transition-all duration-400" data-filter="work" style="background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 2px solid rgba(255, 255, 255, 0.15); box-shadow: 0 5px 20px rgba(59, 130, 246, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);">
      <span class="filter-icon text-xl">ðŸ’¼</span>
      <span class="filter-text-full">Work</span>
      <span class="filter-text-short hidden">Work</span>
    </button>
    <button class="exp-filter-btn flex items-center gap-2 px-6 py-3 rounded-full text-white text-[15px] font-semibold cursor-pointer relative overflow-hidden transition-all duration-400" data-filter="opensource" style="background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 2px solid rgba(255, 255, 255, 0.15); box-shadow: 0 5px 20px rgba(59, 130, 246, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);">
      <span class="filter-icon text-xl">ðŸš€</span>
      <span class="filter-text-full">Open Source</span>
      <span class="filter-text-short hidden">Open</span>
    </button>
    <button class="exp-filter-btn flex items-center gap-2 px-6 py-3 rounded-full text-white text-[15px] font-semibold cursor-pointer relative overflow-hidden transition-all duration-400" data-filter="internship" style="background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 2px solid rgba(255, 255, 255, 0.15); box-shadow: 0 5px 20px rgba(59, 130, 246, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1);">
      <span class="filter-icon text-xl">ðŸŽ“</span>
      <span class="filter-text-full">Internship</span>
      <span class="filter-text-short hidden">Intern</span>
    </button>
  </div>

  <!-- Experience Timeline -->
  <div class="experience-timeline-container relative max-w-[1000px] mx-auto px-5">
    <div class="experience-timeline-line absolute top-0 bottom-0 w-1" style="background: linear-gradient(180deg, transparent 0%, var(--primary) 5%, var(--primary) 95%, transparent 100%); box-shadow: 0 0 15px var(--primary);"></div>

    <div class="experience-boxes flex flex-col gap-8 relative" id="experience-boxes">
      {experiences.slice(0, 6).map((exp, index) => (
        <div class="exp-box relative exp-card-ready" data-category={exp.category}>
          <div class="timeline-dot absolute w-5 h-5 rounded-full z-10 animate-pulse-dot" style="background: var(--gradient2); box-shadow: 0 0 0 6px rgba(26, 15, 62, 0.9), 0 0 20px var(--primary);">
            <div class="dot-inner w-2.5 h-2.5 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-dot-pulse" style="background: var(--secondary);"></div>
          </div>

          <div class="exp-content rounded-[20px] p-6 transition-all duration-500" style="background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); border: 2px solid rgba(255, 255, 255, 0.15); box-shadow: 0 10px 40px rgba(95, 39, 205, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);">
            <div class="exp-header flex items-start justify-between gap-4 mb-4 flex-wrap">
              <div class="company-info flex-1">
                <div class="company-badge inline-flex items-center gap-2 px-4 py-2 rounded-full mb-3" style="background: rgba(59, 130, 246, 0.2); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(59, 130, 246, 0.4); box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3); width: fit-content;">
                  <span class="text-sm font-bold text-white uppercase tracking-wide" style="word-break: break-word; line-height: 1.3;">{exp.company}</span>
                </div>
                <h3 class="text-xl font-bold m-0 mb-2" style="background: var(--gradient2); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">{exp.role}</h3>
              </div>
              <div class="duration-badge flex items-center gap-2 px-4 py-2 rounded-full" style="background: rgba(217, 70, 239, 0.2); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(217, 70, 239, 0.4); box-shadow: 0 5px 15px rgba(217, 70, 239, 0.3);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span class="text-sm font-semibold text-white">{exp.duration}</span>
              </div>
            </div>

            <ul class="exp-description list-none p-0 m-0 flex flex-col gap-2.5">
              {exp.description.map((desc) => (
                <li class="flex items-start gap-3 text-sm leading-relaxed" style="color: rgba(255, 255, 255, 0.9);">
                  <span class="text-base flex-shrink-0 mt-0.5" style="color: var(--primary);">â–¹</span>
                  <span set:html={desc}></span>
                </li>
              ))}
            </ul>
          </div>
        </div>
      ))}

      {experiences.slice(6).map((exp, index) => (
        <div class="exp-box hidden-exp relative exp-card-ready" data-category={exp.category} style="display: none;">
          <div class="timeline-dot absolute w-5 h-5 rounded-full z-10 animate-pulse-dot" style="background: var(--gradient2); box-shadow: 0 0 0 6px rgba(26, 15, 62, 0.9), 0 0 20px var(--primary);">
            <div class="dot-inner w-2.5 h-2.5 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-dot-pulse" style="background: var(--secondary);"></div>
          </div>

          <div class="exp-content rounded-[20px] p-6 transition-all duration-500" style="background: rgba(26, 15, 62, 0.3); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px); border: 2px solid rgba(255, 255, 255, 0.15); box-shadow: 0 10px 40px rgba(95, 39, 205, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1);">
            <div class="exp-header flex items-start justify-between gap-4 mb-4 flex-wrap">
              <div class="company-info flex-1">
                <div class="company-badge inline-flex items-center gap-2 px-4 py-2 rounded-full mb-3" style="background: rgba(59, 130, 246, 0.2); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(59, 130, 246, 0.4); box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3); width: fit-content;">
                  <span class="text-sm font-bold text-white uppercase tracking-wide" style="word-break: break-word; line-height: 1.3;">{exp.company}</span>
                </div>
                <h3 class="text-xl font-bold m-0 mb-2" style="background: var(--gradient2); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">{exp.role}</h3>
              </div>
              <div class="duration-badge flex items-center gap-2 px-4 py-2 rounded-full" style="background: rgba(217, 70, 239, 0.2); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(217, 70, 239, 0.4); box-shadow: 0 5px 15px rgba(217, 70, 239, 0.3);">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span class="text-sm font-semibold text-white">{exp.duration}</span>
              </div>
            </div>

            <ul class="exp-description list-none p-0 m-0 flex flex-col gap-2.5">
              {exp.description.map((desc) => (
                <li class="flex items-start gap-3 text-sm leading-relaxed" style="color: rgba(255, 255, 255, 0.9);">
                  <span class="text-base flex-shrink-0 mt-0.5" style="color: var(--primary);">â–¹</span>
                  <span set:html={desc}></span>
                </li>
              ))}
            </ul>
          </div>
        </div>
      ))}
    </div>
  </div>

  <!-- Load More Button -->
  <div class="load-more-container flex justify-center mt-12" id="load-more-container">
    <button class="load-more-btn flex items-center gap-3 px-8 py-4 rounded-full text-white text-base font-bold cursor-pointer transition-all duration-400" id="load-more-btn" style="background: rgba(59, 130, 246, 0.3); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 2px solid rgba(59, 130, 246, 0.5); box-shadow: 0 8px 32px rgba(59, 130, 246, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.15);">
      <span class="load-more-text-full">Load More Experiences</span>
      <span class="load-more-text-short hidden">Load More</span>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="transition-transform duration-300">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </button>
  </div>
</section>

<script>
  // Filter functionality
  const filterBtns = document.querySelectorAll('.exp-filter-btn');
  const expBoxes = document.querySelectorAll('.exp-box');

  filterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const filter = btn.getAttribute('data-filter');

      // Update active button
      filterBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Filter experiences
      expBoxes.forEach(box => {
        const category = box.getAttribute('data-category');

        if (filter === 'all' || category === filter) {
          box.style.display = 'block';
          setTimeout(() => {
            box.style.opacity = '1';
            box.style.transform = 'translateY(0)';
          }, 10);
        } else {
          box.style.opacity = '0';
          box.style.transform = 'translateY(20px)';
          setTimeout(() => {
            box.style.display = 'none';
          }, 300);
        }
      });
    });
  });

  // Load More functionality
  const loadMoreBtn = document.getElementById('load-more-btn');
  const hiddenExps = document.querySelectorAll('.hidden-exp');

  if (hiddenExps.length === 0) {
    const container = document.getElementById('load-more-container');
    if (container) container.style.display = 'none';
  }

  loadMoreBtn?.addEventListener('click', () => {
    hiddenExps.forEach((exp, index) => {
      setTimeout(() => {
        exp.style.display = 'block';
        exp.classList.remove('hidden-exp');
        setTimeout(() => {
          exp.style.opacity = '1';
          exp.style.transform = 'translateY(0)';
        }, 10);
      }, index * 100);
    });

    const container = document.getElementById('load-more-container');
    if (container) {
      container.style.opacity = '0';
      setTimeout(() => {
        container.style.display = 'none';
      }, 300);
    }
  });

  // Hover effects for filter buttons
  filterBtns.forEach(btn => {
    btn.addEventListener('mouseenter', () => {
      const icon = btn.querySelector('.filter-icon');
      if (icon) icon.style.transform = 'scale(1.2) rotate(10deg)';
    });

    btn.addEventListener('mouseleave', () => {
      const icon = btn.querySelector('.filter-icon');
      if (icon) icon.style.transform = 'scale(1) rotate(0deg)';
    });
  });

  // Hover effects for experience boxes
  expBoxes.forEach(box => {
    const content = box.querySelector('.exp-content');

    box.addEventListener('mouseenter', () => {
      if (content) {
        content.style.background = 'rgba(59, 130, 246, 0.2)';
        content.style.backdropFilter = 'blur(30px)';
        content.style.border = '2px solid rgba(59, 130, 246, 0.6)';
        content.style.boxShadow = '0 20px 60px var(--primary), inset 0 1px 0 rgba(255, 255, 255, 0.2)';
        content.style.transform = 'translateX(10px)';
      }
    });

    box.addEventListener('mouseleave', () => {
      if (content) {
        content.style.background = 'rgba(26, 15, 62, 0.3)';
        content.style.backdropFilter = 'blur(25px)';
        content.style.border = '2px solid rgba(255, 255, 255, 0.15)';
        content.style.boxShadow = '0 10px 40px rgba(95, 39, 205, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.1)';
        content.style.transform = 'translateX(0)';
      }
    });
  });

  // Load More button hover
  loadMoreBtn?.addEventListener('mouseenter', () => {
    loadMoreBtn.style.background = 'rgba(59, 130, 246, 0.5)';
    loadMoreBtn.style.border = '2px solid rgba(59, 130, 246, 0.8)';
    loadMoreBtn.style.transform = 'translateY(-3px) scale(1.05)';
    loadMoreBtn.style.boxShadow = '0 12px 40px rgba(59, 130, 246, 0.7), inset 0 1px 0 rgba(255, 255, 255, 0.25)';
    const svg = loadMoreBtn.querySelector('svg');
    if (svg) svg.style.transform = 'translateY(3px)';
  });

  loadMoreBtn?.addEventListener('mouseleave', () => {
    loadMoreBtn.style.background = 'rgba(59, 130, 246, 0.3)';
    loadMoreBtn.style.border = '2px solid rgba(59, 130, 246, 0.5)';
    loadMoreBtn.style.transform = 'translateY(0) scale(1)';
    loadMoreBtn.style.boxShadow = '0 8px 32px rgba(59, 130, 246, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.15)';
    const svg = loadMoreBtn.querySelector('svg');
    if (svg) svg.style.transform = 'translateY(0)';
  });

  // Intersection Observer for animations
  const observerOptions = { threshold: 0.1, rootMargin: '0px' };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const expCards = entry.target.querySelectorAll('.exp-card-ready');
        expCards.forEach((card, index) => {
          setTimeout(() => {
            card.classList.add('exp-card-animated');
            card.classList.remove('exp-card-ready');
          }, index * 100);
        });
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  const expSection = document.querySelector('.experience');
  if (expSection) observer.observe(expSection);

  // Style for focus class in descriptions
  const focusElements = document.querySelectorAll('.focus');
  focusElements.forEach(el => {
    el.style.background = 'var(--gradient3)';
    el.style.backgroundClip = 'text';
    el.style.webkitBackgroundClip = 'text';
    el.style.webkitTextFillColor = 'transparent';
    el.style.fontWeight = '700';
  });
</script>

<style>
  @keyframes titleGlow {
    0%, 100% { filter: drop-shadow(0 0 20px rgba(240, 147, 251, 0.5)); }
    50% { filter: drop-shadow(0 0 30px rgba(240, 147, 251, 0.8)); }
  }

  @keyframes float-bg {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(50px, 50px); }
  }

  @keyframes float-bg-reverse {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(-50px, -50px); }
  }

  @keyframes dot-pulse {
    0%, 100% { transform: translate(-50%, -50%) scale(1); }
    50% { transform: translate(-50%, -50%) scale(1.3); }
  }

  .animate-float-bg { animation: float-bg 20s ease-in-out infinite; }
  .animate-float-bg-reverse { animation: float-bg-reverse 25s ease-in-out infinite; }
  .animate-pulse-dot { animation: pulse 2s ease-in-out infinite; }
  .animate-dot-pulse { animation: dot-pulse 2s ease-in-out infinite; }

  .exp-filter-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: var(--gradient3);
    transition: left 0.4s ease;
    z-index: -1;
  }

  .exp-filter-btn:hover::before,
  .exp-filter-btn.active::before {
    left: 0;
  }

  .exp-filter-btn:hover,
  .exp-filter-btn.active {
    background: rgba(59, 130, 246, 0.3);
    border: 2px solid rgba(59, 130, 246, 0.6);
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 10px 35px rgba(59, 130, 246, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }

  .exp-filter-btn.active {
    background: rgba(59, 130, 246, 0.4);
    border: 2px solid rgba(59, 130, 246, 0.7);
  }

  .filter-icon {
    transition: transform 0.3s ease;
  }

  .exp-box {
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.3s ease;
  }

  .exp-card-animated {
    animation: expCardFadeIn 0.6s ease-out forwards;
  }

  @keyframes expCardFadeIn {
    0% { opacity: 0; transform: translateY(20px); }
    100% { opacity: 1; transform: translateY(0); }
  }

  .text span:hover {
    background: rgba(59, 130, 246, 0.25);
    backdrop-filter: blur(25px);
    -webkit-backdrop-filter: blur(25px);
    border: 1px solid rgba(59, 130, 246, 0.6);
    box-shadow: 0 12px 40px rgba(59, 130, 246, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
  }

  /* Responsive Styles */

  /* Title and Subtitle Responsive Sizing */
  .experience-title {
    font-size: clamp(2rem, 8vw, 3.5vw);
  }

  .experience-subtitle {
    font-size: clamp(0.875rem, 3.5vw, 1.3vw);
  }

  /* Mobile Styles (< 640px) */
  @media (max-width: 639px) {
    .experience {
      padding: 4rem 1rem 3rem;
    }

    /* Hide full text, show short text on mobile */
    .filter-text-full {
      display: none;
    }

    .filter-text-short {
      display: inline;
    }

    .load-more-text-full {
      display: none;
    }

    .load-more-text-short {
      display: inline;
    }

    /* Filter buttons smaller on mobile */
    .exp-filter-btn {
      padding: 0.5rem 1rem;
      font-size: 13px;
      gap: 0.375rem;
    }

    .filter-icon {
      font-size: 1rem;
    }

    /* Timeline positioning for mobile */
    .experience-timeline-line {
      left: 10px;
    }

    .exp-box {
      padding-left: 35px;
    }

    .timeline-dot {
      left: 2px;
      top: 1.5rem;
    }

    /* Experience cards on mobile */
    .exp-content {
      padding: 1rem;
    }

    .exp-header {
      flex-direction: column;
      gap: 0.75rem;
    }

    .company-badge {
      padding: 0.5rem 0.75rem;
      font-size: 0.75rem;
    }

    .exp-header h3 {
      font-size: 1.125rem;
    }

    .duration-badge {
      padding: 0.5rem 0.75rem;
      font-size: 0.75rem;
      align-self: flex-start;
    }

    .duration-badge svg {
      width: 14px;
      height: 14px;
    }

    .exp-description li {
      font-size: 0.8125rem;
      gap: 0.5rem;
    }

    /* Load More button on mobile */
    .load-more-btn {
      padding: 0.75rem 1.5rem;
      font-size: 0.875rem;
      gap: 0.5rem;
    }

    .load-more-btn svg {
      width: 16px;
      height: 16px;
    }

    /* Disable hover effects on mobile */
    .exp-box:hover .exp-content {
      transform: translateX(0) !important;
    }
  }

  /* Tablet Styles (640px - 1023px) */
  @media (min-width: 640px) and (max-width: 1023px) {
    .experience {
      padding: 5rem 2rem 4rem;
    }

    /* Timeline positioning for tablet */
    .experience-timeline-line {
      left: 20px;
    }

    .exp-box {
      padding-left: 50px;
    }

    .timeline-dot {
      left: 12px;
      top: 2rem;
    }

    /* Experience cards on tablet */
    .exp-content {
      padding: 1.25rem;
    }

    .company-badge {
      padding: 0.625rem 1rem;
      font-size: 0.8125rem;
    }

    .exp-header h3 {
      font-size: 1.25rem;
    }

    .duration-badge {
      padding: 0.625rem 1rem;
      font-size: 0.8125rem;
    }

    .exp-description li {
      font-size: 0.875rem;
    }

    /* Disable hover transform on tablet */
    .exp-box:hover .exp-content {
      transform: translateX(5px) !important;
    }
  }

  /* Medium Laptop Styles (1024px - 1200px) - Fix potential overflow */
  @media (min-width: 1024px) and (max-width: 1200px) {
    .experience-timeline-line {
      left: 30px;
    }

    .exp-box {
      padding-left: 60px;
    }

    .timeline-dot {
      left: 22px;
      top: 2rem;
    }

    .exp-content {
      padding: 1.25rem;
    }

    .company-badge {
      padding: 0.625rem 1rem;
      font-size: 0.8125rem;
    }

    .exp-header h3 {
      font-size: 1.125rem;
    }

    .duration-badge {
      padding: 0.625rem 1rem;
      font-size: 0.8125rem;
    }

    .duration-badge svg {
      width: 14px;
      height: 14px;
    }

    .exp-description li {
      font-size: 0.8125rem;
      gap: 0.625rem;
    }
  }

  /* Desktop Styles (1024px+) */
  @media (min-width: 1024px) {
    .experience-timeline-line {
      left: 30px;
    }

    .exp-box {
      padding-left: 60px;
    }

    .timeline-dot {
      left: 22px;
      top: 2rem;
    }
  }
</style>
